<ion-content padding color="light">
  <h1 text-center>{{ programName }}</h1><br>
  <a color="primary" routerLink="/events" *ngIf="haveEvents">
    <ion-icon name="calendar" class="calendar" float-right></ion-icon>
  </a>
  <div text-center padding>
    <ng-container *ngIf="loadingProgress; else progressTpl">
      <ion-spinner></ion-spinner>
    </ng-container>
    <ng-template #progressTpl>
      <circle-progress
        [percent]="progress"
        [radius]= "70"
        [subtitle]="COMPLETE"
        [outerStrokeWidth]= "12"
        [backgroundPadding]= -10
        [maxPercent]= 100
        [showInnerStroke]= true
        [startFromZero]= false
        [outerStrokeLinecap]= "round"
        >
      </circle-progress>
    </ng-template>
  </div>

  <ng-container *ngIf="achievements[0]">
    <div class="achievement">
      <ion-label color="medium">My Badges</ion-label>
      <ion-label >
        <a color="primary" routerLink="/achievements">View all</a>
      </ion-label>
    </div>
    <ion-grid>
      <ion-row text-center margin-bottom>
        <ion-col
          *ngFor="let achievement of achievements; let i = index;"
          size-xs="4"
          size-sm="3"
          size-md="2"
        >
        <achievement-badge
          [achievement]="achievement"
        ></achievement-badge>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ng-container>

  <ion-label color="medium">Things to do</ion-label>
  <ion-list class="todo-list" lines="none">

    <ng-container *ngIf="loadingTodoItems; else todoItemsTpl">
      <ion-spinner></ion-spinner>
    </ng-container>

    <ng-template #todoItemsTpl>
      <ng-container *ngIf="todoItems.length; else noItemsTpl">
        <div *ngFor="let todoItem of todoItems">
          <ng-container [ngSwitch]="todoItem.type">
            <app-todo-card
              *ngSwitchCase="'feedback_available'"
              [todoItem]="todoItem"
              (click)="goToAssessment(todoItem.meta.activity_id, todoItem.meta.context_id, todoItem.meta.assessment_id)"
            ></app-todo-card>
            <app-todo-card
              *ngSwitchCase="'review_submission'"
              [todoItem]="todoItem"
              (click)="goToReview(todoItem.meta.context_id, todoItem.meta.assessment_id, todoItem.meta.assessment_submission_id)"
            ></app-todo-card>
            <app-todo-card
              *ngSwitchCase="'chat'"
              [todoItem]="todoItem"
              (click)="goToChat()"
            ></app-todo-card>
          </ng-container>
        </div>
      </ng-container>

      <ng-template #noItemsTpl>
        <app-todo-card [todoItem]="false"></app-todo-card>
      </ng-template>
    </ng-template>

  </ion-list>

  <ion-label color="medium">Current Activity</ion-label>
  <ng-container *ngIf="loadingActivity; else activityTpl">
    <br><ion-spinner></ion-spinner>
  </ng-container>
  <ng-template #activityTpl>
    <app-activity-card [activity]="activity" (click)="!activity.isLocked && goToActivity(activity.id)"></app-activity-card>
  </ng-template>
</ion-content>
